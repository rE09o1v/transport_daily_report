# Transport Daily Report - Serena MCP Project Context

## Project Overview
**Project**: Transport Daily Report (transport_daily_report)
**Technology**: Flutter 3.29.3, Dart 3.7.2
**Industry**: Transportation & Logistics Daily Report Management
**Platforms**: Android, iOS, Web, Windows, macOS, Linux
**Language**: Japanese (Complete localization)

## Architecture Analysis

### Core Technology Stack
```yaml
# Location Services
geolocator: ^14.0.0
permission_handler: ^12.0.0+1

# Storage & Persistence
shared_preferences: ^2.2.2
path_provider: ^2.1.5

# PDF Generation & Sharing
pdf: ^3.11.3
share_plus: ^11.0.0

# Internationalization
flutter_localizations: (SDK)
intl: ^0.19.0
```

### Directory Structure
```
lib/
├── models/          # 4 Data Models
│   ├── client.dart              # Customer information with GPS coordinates
│   ├── daily_record.dart        # Daily business records aggregation
│   ├── roll_call_record.dart    # Roll call records (legal requirement)
│   └── visit_record.dart        # Customer visit logs with GPS tracking
├── screens/         # 9 UI Screens
│   ├── home_screen.dart         # Main tab navigation (4 tabs)
│   ├── visit_list_screen.dart   # Visit record listing
│   ├── visit_entry_screen.dart  # Visit record registration
│   ├── visit_detail_screen.dart # Visit record detail view
│   ├── client_list_screen.dart  # Customer management listing
│   ├── client_detail_screen.dart# Customer detail/edit screen
│   ├── roll_call_screen.dart    # Roll call registration
│   ├── roll_call_list_screen.dart# Roll call listing
│   └── history_screen.dart      # Historical data & PDF export
├── services/        # 3 Core Services
│   ├── storage_service.dart     # Data persistence (JSON + SharedPreferences)
│   ├── location_service.dart    # GPS location handling
│   └── pdf_service.dart         # PDF generation (roll call sheets, daily reports)
└── utils/          # 2 Platform Abstraction
    ├── io_html_stub.dart        # Platform-specific implementations
    └── web_file_stub.dart       # Web/native file handling
```

## Key Features & Business Logic

### 1. Visit Record Management (Tab 1)
- **GPS Integration**: Automatic location capture during visits
- **Time Tracking**: Precise visit start/end times
- **Customer Association**: Link visits to registered customers
- **Search Radius**: 300m proximity search for nearby customers

### 2. Customer Management (Tab 2)  
- **CRUD Operations**: Full customer data management
- **Location Storage**: GPS coordinates for each customer
- **Proximity Search**: Find customers within 300m of current location
- **Data Export**: CSV/PDF export capabilities

### 3. Roll Call Records (Tab 3)
- **Legal Compliance**: Transportation law requirement
- **Alcohol Detection**: Breathalyzer result recording (mg/L)
- **Morning/Evening**: Separate roll call sessions
- **Officer Records**: Roll call executing officer information

### 4. History & Reporting (Tab 4)
- **Data Visualization**: Historical data browsing
- **PDF Generation**: Professional roll call sheets and daily reports
- **Export Functions**: Share via multiple platforms
- **Date Range Filtering**: Flexible date-based queries

## Technical Implementation Details

### Data Persistence Strategy
- **Primary**: JSON files via path_provider
- **Secondary**: SharedPreferences for settings
- **Web Fallback**: SharedPreferences-only for web platform
- **Async Patterns**: Completer-based synchronization

### Location Service Integration
- **High Accuracy GPS**: Precise location tracking
- **Permission Handling**: Runtime permission requests
- **Platform Support**: Native iOS/Android + Web API fallback

### PDF Generation System
- **Japanese Font Support**: IPAex Gothic font integration
- **Legal Templates**: Roll call sheet formatting per transportation law
- **Multi-page Reports**: Daily summary reports with visit details

## Quality Analysis (Current State)

### Code Quality Issues (122 total)
- **Critical**: 89 avoid_print violations (production logging needed)
- **Async/UI**: 15 use_build_context_synchronously warnings
- **API Usage**: 7 deprecated_member_use (share_plus, withOpacity)
- **Code Cleanliness**: 11 unused imports/variables/methods

### Priority Fix Areas
1. **High**: Implement production logging system (replace print statements)
2. **Medium**: Fix async BuildContext usage patterns  
3. **Low**: Clean unused code and update deprecated APIs

## Development Patterns & Standards

### Coding Conventions
- **Variables/Functions**: English (international standard)
- **Comments/UI**: Japanese (business requirement)
- **Indentation**: 2 spaces standard
- **State Management**: StatefulWidget with setState pattern

### File Naming
- **Screens**: `{feature}_screen.dart`
- **Models**: `{entity}.dart`
- **Services**: `{purpose}_service.dart`

### Architecture Pattern
- **Separation**: Models, Views, Services clear separation
- **Storage**: Repository pattern with StorageService
- **Location**: Service layer abstraction
- **PDF**: Dedicated service with template system

## Business Domain Knowledge

### Transportation Industry Requirements
- **Roll Call Compliance**: Legal requirement for commercial transport
- **Alcohol Testing**: Mandatory breathalyzer testing and recording
- **Visit Documentation**: Customer visit proof with GPS verification
- **Daily Reports**: Management reporting for operational oversight

### User Experience Focus
- **One-tap Recording**: Minimize driver interaction time
- **Offline Support**: Full functionality without network
- **Japanese UI**: Complete Japanese localization
- **Multi-platform**: Consistent experience across devices

## Development Recommendations

### Immediate Priorities
1. **Logging System**: Replace print with proper logging framework
2. **Error Handling**: Enhance async error handling patterns
3. **Code Quality**: Address lint warnings systematically

### Future Enhancements
1. **Cloud Sync**: Multi-device data synchronization
2. **Advanced Reports**: Extended PDF template system
3. **Multi-language**: Korean/English language support

## Integration Points

### External Dependencies
- **Platform Services**: GPS, file system, permissions
- **Native Features**: Camera, sharing, PDF viewing
- **Web Compatibility**: Platform-specific implementations

### Data Export/Import
- **PDF Export**: Professional report generation
- **Data Sharing**: Cross-platform file sharing
- **Backup/Restore**: JSON-based data portability

---
**Generated**: 2025-01-11
**Context Purpose**: Serena MCP alternative project initialization
**Update Trigger**: When major architectural changes occur